1  COM I$[20],N$[20],N1$[25],W[10],K[34],P[20,20],R[30],M0$[240]
2  COM R,C,S2,G,R1,A2,T,S1,H1,H3,N7,L,C9
20  COM T$[8],T0$[72],U$[8],U0$[160],O$[5],A0$[210],W$[130],D$[5]
30  COM M$[9],M[10,30],F[10,30]
40  COM A[10],E[10],S[30],G1,V,X,W1,P2,A$[21]
50  B=BRK(0)
80  FILES *
1075  GOSUB 9700
1080  W1=0
1290  REM *** A Target for top of the loop
2155  PRINT
2160  PRINT N1$;
2161  PRINT  USING 2162;R,C
2162  IMAGE #," is now standing in room #(",DD,",",DD,"), Level #"
2164  PRINT L
2170  REM
2180  PRINT
2185  IF SYS(3) THEN 4080
2190  T1=TIM(0)+60*TIM(1)+1440*TIM(2)
2200  IF T1-T<(5+R1*R1/L/2 ** C9) MIN 5000 AND T1-T >= 0 THEN 2236
2210  T=T1
2220  S2=INT(S2+(20+5*R1-S2)/2)
2225  N7=0
2230  PRINT N1$"'s natural healing powers bring strength up to ";S2
2235  PRINT
2236  IF S2 >= 0 THEN 2240
2237  PRINT N1$;" is too sick to move."
2238  GOTO 4080
2240  PRINT "ACTION";
2250  INPUT O$
2255  O$=UPS$(O$)
2260  IF O$[1,1]="L" THEN 2400
2262  IF O$[1,1]="H" THEN 9000
2270  IF O$[1,1]="W" THEN 2400
2275  IF O$[1,1]="R" THEN 4400
2280  IF O$[1,1]="F" THEN 2340
2283  IF O$[1,1]="Q" THEN 4080
2293  IF O$[1,1]="M" THEN 5060
2295  IF O$[1,1]#"S" THEN 2310
2300  GOSUB 8500
2305  GOTO 2170
2310  PRINT "The possible actions are: LOOK, WALK, FIGHT, FD, HEAL,"
2315  PRINT SPA(26);"STATS, RINGS, MAP, and QUIT"
2320  GOTO 2170
2340  IF INT(P[R,C]*10)>0 THEN 2370
2350  PRINT "Sorry ";N1$;", but there is nothing here to fight!"'7'7
2360  GOTO 2170
2370  GOSUB 3410
2390  GOTO 2170
2400  PRINT "Direction";
2420  INPUT D$
2425  D$=UPS$(D$)
2430  IF D$[1,1]="N" THEN 2500
2440  IF D$[1,1]="E" THEN 2500
2450  IF D$[1,1]="S" THEN 2500
2460  IF D$[1,1]="W" THEN 2500
2470  IF D$[1,1]="H" THEN 2500
2480  PRINT "The possible directions are: NORTH,SOUTH,EAST,WEST & HERE"
2490  GOTO 2400
2500  REM
2501  IF INT(P[R,C]*10)=0 THEN 2522
2510  IF P[R,C]<0 THEN 2530
2520  GOSUB 3760
2522  IF RND(5)>.005 THEN 2530
2524  P[R,C]=P[R,C]+INT(RND(5)*(L MAX 9)+1)/10
2526  GOSUB 4200
2528  PRINT LIN(1);"Ambush! "'7"There are now";V;" ";M$;" in Room #(";R;",";C;")"
2530  Z=P[R,C]*1.E+06-INT(P[R,C]*100000.)*10
2540  GOTO Z+1 OF 2890,2550,2570,2590,2610,2630,2660,2690,2720,2750
2550  IF D$[1,1]#"N" THEN 2890
2560  GOTO 2780
2570  IF D$[1,1]#"E" THEN 2890
2580  GOTO 2780
2590  IF D$[1,1]#"S" THEN 2890
2600  GOTO 2780
2610  IF D$[1,1]#"W" THEN 2890
2620  GOTO 2780
2630  IF D$[1,1]="N" THEN 2780
2640  IF D$[1,1]="E" THEN 2780
2650  GOTO 2890
2660  IF D$[1,1]="N" THEN 2780
2670  IF D$[1,1]="S" THEN 2780
2680  GOTO 2890
2690  IF D$[1,1]="N" THEN 2780
2700  IF D$[1,1]="W" THEN 2780
2710  GOTO 2890
2720  IF D$[1,1]="E" THEN 2780
2730  IF D$[1,1]="S" THEN 2780
2740  GOTO 2890
2750  IF D$[1,1]="E" THEN 2780
2760  IF D$[1,1]="W" THEN 2780
2770  GOTO 2890
2780  PRINT "The door to that room is locked."
2810  IF N7#4 THEN 2840
2815  IF O$[1,1]#"L" THEN 2840
2820  PRINT "But  ";N1$;" uses his X-ray vision!"'7
2830  GOTO 2930
2840  Y=P[R,C]*100000.-INT(P[R,C]*1000)*100
2850  Y=INT(Y/3)
2853  IF K[Y+1]<L THEN 2170
2856  IF RND(5)>.05 THEN 2870
2859  K[Y+1]=L-1
2862  PRINT "And ";N1$;"'s #";Y+1;" key breaks in the lock."
2865  GOTO 2170
2870  PRINT "But it opens to ";N1$;"'s #";Y+1;" key!"'7'7
2880  GOTO 2930
2890  IF D$[1,1]="H" THEN 2930
2920  PRINT "OPEN DOOR!"
2930  R4=R
2940  C4=C
2950  IF D$[1,1]#"N" THEN 2970
2960  R4=R-1
2970  IF D$[1,1]#"S" THEN 2990
2980  R4=R+1
2990  IF D$[1,1]#"E" THEN 3010
3000  C4=C+1
3010  IF D$[1,1]#"W" THEN 3030
3020  C4=C-1
3030  IF C4<1 OR C4>20 THEN 3050
3040  IF R4>0 AND R4<21 THEN 3070
3050  PRINT "This door opens on to a writhing grey mist!"
3053  IF O$[1,1]="L" THEN 2170
3055  PRINT
3060  PRINT "The mist surrounds him, spins him.  ";N1$;" knows"
3062  PRINT SPA(16)"He has been WARPED!"
3064  R4=INT(RND(5)*20)+1
3066  C4=INT(RND(5)*20)+1
3070  REM NEW ROOM
3080  IF P[R4,C4]#0 THEN 3110
3090  P[R4,C4]=RND(5)
3110  V=INT(P[R4,C4]*10)
3115  IF V>(L+2) THEN 3090
3120  X=INT((INT(P[R4,C4]*1000)-V*100)/3)
3140  IF X>(20+L) THEN 3090
3150  IF O$[1,1]="L" THEN 3240
3160  R=R4
3170  C=C4
3180  H1=H3=0
3190  PRINT N1$;" is now in room # (";R;",";C;")"
3191  IF INT(P[R,C])#-11 THEN 3193
3192  CHAIN "STORE.A100",5000
3193  IF P[R,C]#-7 THEN 3208
3194  PRINT
3196  PRINT "There is a stairway leading down.  Do you want to take it";
3198  INPUT O$
3200  O$=UPS$(O$)
3202  IF O$[1,1]#"Y" THEN 2170
3204  L=L+1
3206  CHAIN "DRAGON.A100",1290
3208  IF P[R,C]#-5 THEN 3230
3210  PRINT
3212  PRINT "There is a stairway leading up.  Do you want to take it";
3214  INPUT O$
3216  O$=UPS$(O$)
3218  IF O$[1,1]#"Y" THEN 2170
3220  L=L-1
3222  IF L=0 THEN 3224
3223  CHAIN "DRAGON.A100",1290
3224  PRINT
3226  PRINT SPA(8)"A stairway out!!!"'7'7'7"  You're FREE!"'7"!"'7"!"'7
3227  PRINT LIN(2)
3228  CHAIN "LORDS.A100",7000
3230  IF INT(P[R,C])#-9 THEN 2170
3232  CHAIN "LORDS.A100",2000
3240  IF V <= 0 THEN 3305
3260  M$=M0$[8*X+1,8*X+8]
3262  GOSUB 9750
3265  IF N7#1 THEN 3280
3270  PRINT N1$;" sees nothing, because he is blind!"
3275  GOTO 2170
3280  PRINT  USING 3282;R4,C4,V
3282  IMAGE #,"Room # (",DD,",",DD,") has ",D
3283  PRINT " ";M$;" in it."
3285  PRINT "Each of the ";M$;" will take ";S[X+1];" blow to kill."
3300  GOTO 2170
3305  IF P[R4,C4]<0 THEN 3390
3310  IF X=9 AND H1=0 THEN 3370
3330  IF R4#R OR C4#C THEN 3390
3340  R1=R1+.001*H1
3345  CHAIN Z9,"DND2.A100",8000
3350  H1=H3=0
3352  IF R1/L>7 AND RND(5)<.003*(R1/L-7) ** 3 THEN 9500
3354  P[R,C]=(P[R,C]*1000-INT(P[R,C]*1000))/1000
3360  GOTO 2170
3370  PRINT "There is nothing in the room."
3380  GOTO 2170
3390  PRINT "There are no monsters in the room."
3400  GOTO 2170
3410  GOSUB 4200
3450  GOSUB 9610
3550  P2=M[W1,X+1]
3552  IF R[X+1]=0 THEN 3560
3555  P2=INT(P2/2)
3557  R[X+1]=R[X+1]-1
3560  H=0
3562  PRINT "Prob. of hitting/attack:";100-P2;"%"
3563  R3=INT(R1/L) MAX (1)
3564  IF N7#2 THEN 3571
3566  R3=3*R3
3567  IF R1<4*L THEN 3571
3568  R1=R1-R1/25
3570  GOTO 3575
3571  N7=0
3575  PRINT "Number of attacks:";R3
3578  IF H1#0 THEN 3586
3580  S1=S[X+1]*V
3586  FOR J=1 TO R3
3587  A1=INT(RND(5)*100)
3590  IF A1<P2 THEN 3602
3600  H=H+INT(E[W1]*W[W1]/5)
3602  NEXT J
3605  H3=H3+H
3610  H1=H1+H
3632  IF H3<S[X+1] THEN 3640
3634  V1=INT(H3/S[X+1])
3635  IF V1<V THEN 3637
3636  V1=V
3637  P[R,C]=(P[R,C]*10-V1)/10
3638  H3=H3-S[X+1]*V1
3640  REM
3650  FOR I=1 TO INT(V/1.1)+1
3660  Q1=INT(RND(5)*10)+1
3670  U$=U0$[Q1*8-7,Q1*8]
3680  PRINT TAB(32-4*V);U$;
3690  NEXT I
3693  PRINT
3696  PRINT LIN(1);N1$;" uses his ";
3699  IF E[W1]/5=INT(E[W1]*W[W1]/5) THEN 3704
3702  PRINT "Enchanted ";
3704  PRINT W$[W1*13-12,W1*13]
3706  IF H>0 THEN 3720
3708  PRINT "but he misses the ";M$
3710  GOTO 3760
3720  PRINT "and delivers ";H;" blows to the ";M$
3725  S1=S1-H
3730  IF S1>0 THEN 3760
3735  H1=H1+S1
3740  R1=R1+.002*INT(H1/INT(R1) ** 2)
3745  PRINT '7'7'7"GREAT!!!  ";N1$;" just killed the last of the ";M$
3747  P[R,C]=-1
3750  RETURN
3760  GOSUB 4200
3810  P3=F[A2,X+1]
3820  P3=P3-(P3*(L-1)^4/(2.5*L^4))
3830  PRINT LIN(1)"Prob. of each ";M$;" hitting:";INT(100-P3);"%";LIN(1)
3870  H2=0
3890  FOR I=1 TO V
3893  Q1=INT(RND(5)*10)+11
3896  U$=U0$[Q1*8-7,Q1*8]
3910  A1=RND(5)*100
3920  IF A1<P3 THEN 3940
3930  H2=H2+1+INT(S[X+1]/6)
3935  PRINT TAB(32-(V-I)*4);U$;
3940  NEXT I
3945  PRINT
3946  IF N7#3 THEN 3950
3948  H2=INT(H2/3+.7)
3950  S2=S2-H2
3955  IF S2 >= 0 THEN 3962
3957  ASSIGN *,1
3960  PURGE W4,I$
3962  IF H2>0 THEN 3970
3964  PRINT N1$;"'s ";A$;" protects him from the ";V;M$
3968  GOTO 3980
3970  PRINT V;M$;" attacking!!"'7'7"  ";H2;" blows on ";N1$
3980  IF S2<0 THEN 4060
3982  IF W1#0 THEN 3990
3986  GOSUB 9610
3990  PRINT S2;" more blows before ";N1$;" is dead."
3994  P2=P2-3 MAX INT(M[W1,X+1]/2)
3995  IF O$[1,2]="FD" THEN 3560
4000  H1=H1+INT(H1*(M[W1,X+1]-P2)/P2)
4040  RETURN
4060  PRINT N1$;" JUST DIED!!!"'7'7'7"   The funeral will be held next week..."
4080  CHAIN "LORDS.A100"
4100  GOSUB 4300
4140  PRINT "So-long ";N1$;"!"'7'7'7"  See you soon!!!"'7'7'7'7
4145  STOP
4150  CHAIN "GAMES.A100",200
4200  V=INT(P[R,C]*10)
4210  X=INT((INT(P[R,C]*1000)-V*100)/3)
4220  M$=M0$[8*X+1,8*X+8]
4221  GOSUB 9750
4230  IF X=1 THEN 4250
4250  RETURN
4300  ASSIGN I$[1,11],1,W4
4310  IF W4=3 THEN 4140
4320  PRINT #1,1;N$,N1$,T,R1,R,C,S2,G,A2,S1,H1,H3,N7,L,C9
4330  MAT  PRINT #1;W,R,K,P
4340  RETURN
4400  PRINT LIN(1);SPA(28);"Rings of Power"
4420  FOR I=1 TO 30
4430  IF R[I]=0 THEN 4450
4440  PRINT "(";R[I];") ";M0$[8*I-7,8*I],
4444  IF INT(I/2)#I/2 THEN 4450
4447  PRINT
4450  NEXT I
4460  GOTO 2170
5060  IF INT(P[R,C]*10) <= 0 THEN 5070
5065  GOSUB 3760
5070  IF N7#1 THEN 6000
5080  PRINT N1$;" is blind and cannot read his map."
5090  GOTO 2170
6000  PRINT LIN(1);SPA(27);"Map - Level #";L
6005  PRINT "       1  2  3  4  5  6  7  8  9  0  1  2  3  4  5  6  7  8  9  0"
6010  FOR I=1 TO 20
6025  PRINT I;
6030  FOR J=1 TO 20
6031  IF I=R AND J=C THEN 6061
6034  IF P[I,J]=-1 THEN 6050
6035  IF INT(P[I,J])=-11 THEN 6052
6036  IF INT(P[I,J])=-5 THEN 6055
6040  IF INT(P[I,J])=-7 THEN 6058
6041  IF INT(P[I,J])=-9 THEN 6063
6049  GOTO 6069
6050  PRINT " . ";
6051  GOTO 7020
6052  IF INT(P[I,J])=P[I,J] THEN 6070
6053  PRINT " $ ";
6054  GOTO 7020
6055  IF INT(P[I,J])=P[I,J] THEN 6070
6056  PRINT " ^ ";
6057  GOTO 7020
6058  IF INT(P[I,J])=P[I,J] THEN 6070
6059  PRINT " v ";
6060  GOTO 7020
6061  PRINT " * ";
6062  GOTO 7020
6063  IF INT(P[I,J])=P[I,J] THEN 6070
6064  PRINT " ? ";
6065  GOTO 7020
6069  IF P[I,J]>0 THEN 6090
6070  PRINT "   ";
6075  GOTO 7020
6090  IF INT(P[I,J]*10)=0 THEN 7010
6092  V=INT(P[I,J]*10)
6094  X=INT((INT(P[I,J]*1000)-V*100)/3)
7000  PRINT " ";M0$[8*X+1,8*X+1];" ";
7005  GOTO 7020
7010  PRINT " 0 ";
7020  NEXT J
7030  PRINT
7035  NEXT I
7050  GOTO 2170
7760  GOSUB 8500
7850  RETURN
8440  Y=P[R,C]*100000.-INT(P[R,C]*1000)*100
8450  Y=INT(Y/3)
8455  IF K[Y+1] >= L THEN 8480
8460  PRINT LIN(1);N1$;" also finds a key!"'7'7'7"  It is key number ";Y;"."
8470  PRINT "It will open all doords out of this room, and maybe others."
8475  K[Y+1]=L
8480  RETURN
8500  PRINT "STATUS REPORT"LIN(1)
8510  GOSUB 4300
8540  PRINT "Name    : ";N1$;"     (power behind the throne - ";N$;")"
8545  Z8=0
8546  PRINT "Rank    :";R1
8547  PRINT "Armor   : #";A2;A$
8548  PRINT "Strength:";S2;"blows"
8549  PRINT "Gold    :";G
8555  PRINT "Special Attributes: ";
8556  GOTO N7+1 OF 8557,8559,8561,8563,8565
8557  PRINT "None"
8558  GOTO 8568
8559  PRINT "Blind"
8560  GOTO 8568
8561  PRINT "Berserk"
8562  GOTO 8568
8563  PRINT "Invulnerable"
8564  GOTO 8568
8565  PRINT "X-ray vision"
8568  PRINT "Weapons : ";
8569  FOR I=1 TO 10
8570  IF W[I]=0 THEN 8582
8571  IF Z8=0 THEN 8573
8572  PRINT "          ";
8573  PRINT "#";I;
8575  IF E[I]/5=INT(E[I]*W[I]/5) THEN 8580
8578  PRINT " (";INT(E[I]*W[I]/5);")  Enchanted ";
8580  PRINT W$[I*13-12,I*13]
8581  Z8=1
8582  NEXT I
8584  PRINT
8586  PRINT "Keys for Level #";L
8587  I4=0
8588  FOR I=1 TO 34
8590  IF K[I]<L THEN 8596
8591  PRINT "#";I;
8592  I4=I4+1
8594  IF INT(I4/9)#I4/9 THEN 8596
8595  PRINT
8596  NEXT I
8598  PRINT
8615  PRINT "Cost for total healing: ";20+2*INT(R1*5);" gold"
8620  PRINT  USING 8625;R,C,L
8625  IMAGE "Present Position: Room # (",DD,",",DD,") Level #",DD
8630  RETURN
9000  REM HEAL
9010  L1=20+2*INT(R1*5)
9015  IF G >= L1 THEN 9025
9020  PRINT "Sorry ";N1$;", but you can't afford healing!"
9022  GOTO 2170
9025  G=G-L1
9030  S2=INT(20+5*R1)
9050  GOTO 2170
9500  PRINT LIN(1);SPA(29);"*** ZAP! ***"
9510  PRINT SPA(17)"Automatic Transporter Activated"
9515  L=L+1 MAX L+INT(RND(5)*R1/11)
9520  CHAIN "DRAGON.A100",1290
9610  PRINT "Weapon #";
9630  INPUT W1
9640  IF W1<1 OR W1>10 THEN 9660
9650  IF W[W1] >= 1 THEN 9680
9660  PRINT "Try a weapon you have!"'7
9670  GOTO 9610
9680  RETURN
9700  REM set A$
9710  A$=A0$[A2*21-20,A2*21]
9720  IF POS(A$," ")=0 THEN 9740
9730  A$=A$[1,POS(A$," ")-1]
9740  RETURN
9750  REM Set M$
9760  IF POS(M$," ")=0 THEN 9780
9762  IF V=1 THEN 9770
9764  M$=M$[1,POS(M$," ")-1]
9765  M$[LEN(M$)+1]="s"
9766  GOTO 9780
9770  M$=M$[1,POS(M$," ")-1]
9780  RETURN
9999  END
